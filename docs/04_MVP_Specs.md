è¿™æ˜¯ä¸ºæ‚¨è½¬æ¢å¥½çš„æ ‡å‡† Markdown æ ¼å¼æ–‡æ¡£ã€‚

-----

# ğŸ“‹ Phase 1 MVP åŠŸèƒ½è§„æ ¼è¯´æ˜ä¹¦ (Feature Specs)

  * **é¡¹ç›®ä»£å·**ï¼š PromptOps - Phase 1 (The Perfect Editor)
  * **ä¼˜å…ˆçº§**ï¼š P0 (æœ€é«˜çº§ - æ ¸å¿ƒé˜»æ–­æ€§åŠŸèƒ½)
  * **æ ¸å¿ƒç›®æ ‡**ï¼š å®ç°â€œç»“æ„åŒ–ç¼–å†™â€ã€â€œå®æ—¶æˆæœ¬é¢„ä¼°â€ä¸â€œå•æ¬¡è°ƒè¯•â€çš„é—­ç¯ä½“éªŒã€‚

# 1\. æ ¸å¿ƒäº¤äº’ç•Œé¢ (UI Layout)

  * **æŠ€æœ¯æ ˆ**ï¼š Next.js 14 + Shadcn/ui + Tailwind CSS
  * **P0 - ä¸‰æ å¼å¸ƒå±€ (The Workbench)**:
      * **å·¦ä¾§æ  (Sidebar)**: é¡¹ç›®/æ–‡ä»¶å¤¹å¯¼èˆªã€æ–°å»ºæŒ‰é’®ã€å†å²è®°å½•åˆ—è¡¨ã€‚
      * **ä¸­é—´æ  (Editor)**: æ ¸å¿ƒç¼–è¾‘åŒºï¼ˆæ”¯æŒ Tab åˆ‡æ¢ï¼šCode Mode / Builder Modeï¼‰ã€‚
      * **å³ä¾§æ  (Playground)**: å˜é‡è¾“å…¥åŒºã€æ¨¡å‹é€‰æ‹©å™¨ã€å®æ—¶é¢„è§ˆã€å¯¹è¯è¾“å‡ºçª—å£ã€‚

# 2\. æ¨¡å—ä¸€ï¼šåŒæ¨¡å¼ç¼–è¾‘å™¨ (Dual-Mode Editor)

è¿™æ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒå·®å¼‚åŒ–å–ç‚¹ï¼ˆUSPï¼‰ï¼Œå¿…é¡»æ‰“ç£¨æè‡´ã€‚

## F1.1 Builder Mode (ç»“æ„åŒ–æ„å»ºå™¨) - [æ ¸å¿ƒ]

  * **æè¿°**ï¼š åŸºäº JSON Schema è‡ªåŠ¨ç”Ÿæˆçš„ Form è¡¨å•ã€‚
  * **å­—æ®µå®šä¹‰**ï¼š
      * **Role (Text Input)**: è§’è‰²è®¾å®šã€‚
      * **Task (Textarea)**: æ ¸å¿ƒä»»åŠ¡æè¿°ã€‚
      * **Context (Textarea)**: èƒŒæ™¯ä¿¡æ¯ï¼ˆæ”¯æŒå¤§é‡æ–‡æœ¬ç²˜è´´ï¼‰ã€‚
      * **Constraints (Tag Input)**: æ”¯æŒå›è½¦æ·»åŠ æ ‡ç­¾ï¼ˆå¦‚ "No jargon", "Under 200 words"ï¼‰ã€‚
      * **Few-Shot Examples (Repeater)**: å¯åŠ¨æ€æ·»åŠ å¤šç»„ `{Input} -> {Output}` å¯¹ã€‚
  * **äº¤äº’è¦æ±‚**ï¼š ç”¨æˆ·åœ¨è¡¨å•è¾“å…¥æ—¶ï¼Œå³ä¾§é¢„è§ˆåŒºå¿…é¡»å®æ—¶ (\<100ms) æ›´æ–°æ‹¼è£…å¥½çš„å®Œæ•´ Prompt æ–‡æœ¬ã€‚

## F1.2 Code Mode (æå®¢æ¨¡å¼)

  * **æŠ€æœ¯ç»„ä»¶**ï¼š Monaco Editor (VS Code å†…æ ¸)ã€‚
  * **åŠŸèƒ½**ï¼š
      * æ”¯æŒ Markdown / Jinja2 è¯­æ³•é«˜äº®ã€‚
      * æ”¯æŒ Cmd+S å¿«æ·é”®ä¿å­˜ã€‚
      * **åŒå‘åŒæ­¥**ï¼š åœ¨ Code Mode ä¿®æ”¹å†…å®¹ï¼Œå¦‚æœç¬¦åˆç»“æ„ï¼Œåˆ‡å› Builder Mode åº”èƒ½ä¿ç•™ï¼ˆè‹¥æ— æ³•è§£æåˆ™æç¤ºè¿›å…¥çº¯æ–‡æœ¬æ¨¡å¼ï¼‰ã€‚

# 3\. æ¨¡å—äºŒï¼šæ™ºèƒ½è¾…åŠ©å¼•æ“ (Intelligence Engine)

## F2.1 å˜é‡è‡ªåŠ¨å—…æ¢ (Auto-Variable Detection) - [UX äº®ç‚¹]

  * **é€»è¾‘**ï¼š å‰ç«¯ç›‘å¬ç¼–è¾‘å™¨ `onChange` äº‹ä»¶ã€‚
  * **è§„åˆ™**ï¼š æ­£åˆ™åŒ¹é… `{{variable_name}}`ã€‚
  * **è¡¨ç°**ï¼š
      * ä¸€æ—¦æ£€æµ‹åˆ°æ–°å˜é‡ï¼Œå³ä¾§æ  "Variables" åŒºåŸŸè‡ªåŠ¨å‡ºç°å¯¹åº”çš„ Input æ¡†ã€‚
      * å¦‚æœç”¨æˆ·åˆ é™¤äº†å˜é‡å¼•ç”¨ï¼ŒInput æ¡†è‡ªåŠ¨æ¶ˆå¤±ï¼ˆæˆ–å˜ç°æç¤º unusedï¼‰ã€‚
  * **æŠ€æœ¯æç¤º**ï¼š ä½¿ç”¨ Set æ•°æ®ç»“æ„å»é‡ï¼Œé˜²æ­¢é‡å¤æ¸²æŸ“ã€‚

## F2.2 å®æ—¶æˆæœ¬é›·è¾¾ (Cost Radar) - [ç—›ç‚¹åŠŸèƒ½]

  * **ä½ç½®**ï¼š å³ä¾§æ åº•éƒ¨æˆ–â€œè¿è¡Œâ€æŒ‰é’®æ—ã€‚
  * **é€»è¾‘**ï¼š çº¯å‰ç«¯è®¡ç®— (Client-side Tokenizer)ã€‚
      * å¼•ç”¨ `gpt-tokenizer` åº“ã€‚
  * **å…¬å¼**ï¼š`Est. Cost = (InputTokens * ModelPriceIn) + (MaxOutputTokens * ModelPriceOut)`ã€‚
  * **UI å±•ç¤º**ï¼š
      * æ˜¾ç¤ºï¼š`~450 Tokens | Est: $0.01 (GPT-4)`ã€‚
      * ä¸‹æ‹‰èœå•åˆ‡æ¢æ¨¡å‹æ—¶ï¼Œä»·æ ¼éœ€å³æ—¶è·³å˜ã€‚

# 4\. æ¨¡å—ä¸‰ï¼šè°ƒè¯•æ¸¸ä¹åœº (The Playground)

## F3.1 BYOK æ¨¡å¼ (Bring Your Own Key) - [MVP ç­–ç•¥]

  * **ç­–ç•¥**ï¼š Phase 1 ä¸åšå¤æ‚çš„åç«¯è®¡è´¹ï¼Œç›´æ¥è®©ç”¨æˆ·å¡«è‡ªå·±çš„ Keyã€‚
  * **å®ç°**ï¼š
      * ç”¨æˆ·ç‚¹å‡»è®¾ç½® -\> è¾“å…¥ OpenAI/Anthropic Key -\> å­˜å‚¨åœ¨æµè§ˆå™¨ LocalStorage (å‰ç«¯åŠ å¯†) æˆ– Session ä¸­ã€‚
      * åç«¯ä¸å­˜ Keyï¼Œä»…åšé€ä¼ ï¼ˆProxyï¼‰ï¼Œè§„é¿åˆè§„é£é™©ã€‚

## F3.2 æµå¼å¯¹è¯ (Streaming Response)

  * **æŠ€æœ¯**ï¼š Server-Sent Events (SSE) æˆ– WebSocketã€‚
  * **æ•ˆæœ**ï¼š åƒ ChatGPT ä¸€æ ·æ‰“å­—æœºå¼åå­—ï¼Œè€Œä¸æ˜¯è½¬åœˆç­‰å¾…ã€‚
  * **æ¨¡å‹æ”¯æŒ**ï¼š é¦–å‘æ”¯æŒ `gpt-4o`, `gpt-3.5-turbo`, `claude-3-5-sonnet` (é€šè¿‡ LiteLLM)ã€‚

# 5\. æ•°æ®ç»“æ„è§„èŒƒ (å¯¹äºå¼€å‘å›¢é˜Ÿ)

è¯·åç«¯å›¢é˜Ÿä¸¥æ ¼æŒ‰ç…§æ­¤ Schema å»ºè¡¨ï¼Œä¸ºåç»­é˜¶æ®µæ‰“åŸºç¡€ã€‚

```typescript
// Frontend State Interface
interface PromptState {
  meta: {
    id: string;
    title: string;
    last_modified: number;
  };
  config: {
    model: string; // e.g. "gpt-4o"
    temperature: number;
    max_tokens: number;
  };
  structure: {
    role: string;
    task: string;
    context: string;
    constraints: string[];
    format: string; // "json" | "markdown" | "text"
  };
  // æœ€ç»ˆå‘é€ç»™ LLM çš„æ˜¯è¿™ä¸ª compiled_text
  // compiled_text = role + task + context + constraints...
}
```

# 6\. éªŒæ”¶æ ‡å‡† (Definition of Done)

  * **æ‰€è§å³æ‰€å¾—**ï¼š åœ¨å·¦ä¾§è¡¨å•ä¿®æ”¹ä¸€ä¸ªå­—ï¼Œå³ä¾§ Token è®¡æ•°å™¨å¿…é¡»åœ¨ 200ms å†…æ›´æ–°ã€‚
  * **å˜é‡è”è°ƒ**ï¼š è¾“å…¥ `{{name}}`ï¼Œå³ä¾§å‡ºç°è¾“å…¥æ¡†ï¼›åœ¨è¾“å…¥æ¡†å¡«å…¥ "Liam"ï¼Œç‚¹å‡»è¿è¡Œï¼ŒLLM æ”¶åˆ°çš„å¿…é¡»æ˜¯ "Liam"ã€‚
  * **å¤šæ¨¡å‹åˆ‡æ¢**ï¼š åœ¨ä¸‹æ‹‰èœå•ä» GPT-4 åˆ‡æ¢åˆ° Claude 3.5ï¼Œç‚¹å‡»è¿è¡Œï¼Œèƒ½å¤ŸæˆåŠŸè°ƒç”¨ Claude API å¹¶è¿”å›ç»“æœã€‚